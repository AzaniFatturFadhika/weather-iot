{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://weather-iot/schemas/weather-observation.json",
  "title": "WeatherObservation",
  "description": "Schema.org compliant weather observation data from IoT weather station",
  "type": "object",
  "required": [
    "@context",
    "@type",
    "stationID",
    "gatewayID",
    "name",
    "observationDate",
    "geo",
    "sensors",
    "temperature",
    "humidity",
    "atmosphericPressure",
    "windSpeed",
    "precipitation",
    "illuminance",
    "signal"
  ],
  "properties": {
    "@context": {
      "type": "string",
      "const": "https://schema.org",
      "description": "JSON-LD context"
    },
    "@type": {
      "type": "string",
      "const": "WeatherObservation",
      "description": "Schema.org type"
    },
    "stationID": {
      "type": "string",
      "description": "Unique transmitter identifier",
      "pattern": "^TX[0-9]{3,}$",
      "examples": ["TX001", "TX002", "TX003"]
    },
    "gatewayID": {
      "type": "string",
      "description": "Gateway identifier",
      "examples": ["ESP32_Gateway_001"]
    },
    "name": {
      "type": "string",
      "description": "Human-readable station name",
      "examples": ["Kec. Semarang Utara", "Kec. Semarang Barat"]
    },
    "observationDate": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp with timezone",
      "examples": ["2025-11-23T12:00:00+07:00"]
    },
    "uptimeMs": {
      "type": "integer",
      "description": "Gateway uptime in milliseconds (fallback if NTP fails)",
      "minimum": 0
    },
    "geo": {
      "type": "object",
      "description": "Geographic coordinates (Schema.org GeoCoordinates)",
      "required": ["@type", "latitude", "longitude", "elevation"],
      "properties": {
        "@type": {
          "type": "string",
          "const": "GeoCoordinates"
        },
        "latitude": {
          "type": "number",
          "description": "WGS84 latitude in decimal degrees",
          "minimum": -90,
          "maximum": 90,
          "examples": [-6.9600]
        },
        "longitude": {
          "type": "number",
          "description": "WGS84 longitude in decimal degrees",
          "minimum": -180,
          "maximum": 180,
          "examples": [110.4200]
        },
        "elevation": {
          "type": "number",
          "description": "Elevation in meters above sea level",
          "examples": [10.0]
        }
      }
    },
    "sensors": {
      "type": "array",
      "description": "List of sensors used in this station",
      "items": {
        "type": "string"
      },
      "examples": [["AHT20", "BMP280", "Anemometer", "Raindrop", "LDR"]]
    },
    "temperature": {
      "type": "object",
      "description": "Temperature measurement (Schema.org QuantitativeValue)",
      "required": ["@type", "value", "unitCode", "unitText", "sensor"],
      "properties": {
        "@type": {
          "type": "string",
          "const": "QuantitativeValue"
        },
        "value": {
          "type": "string",
          "description": "Temperature value as string",
          "pattern": "^-?[0-9]+\\.[0-9]{2}$",
          "examples": ["28.50", "-5.20"]
        },
        "unitCode": {
          "type": "string",
          "const": "CEL",
          "description": "UN/CEFACT unit code for Celsius"
        },
        "unitText": {
          "type": "string",
          "const": "Â°C",
          "description": "Human-readable unit"
        },
        "sensor": {
          "type": "string",
          "description": "Sensor identifier",
          "examples": ["AHT20", "DHT22"]
        }
      }
    },
    "humidity": {
      "type": "object",
      "description": "Humidity measurement",
      "required": ["@type", "value", "unitCode", "unitText", "sensor"],
      "properties": {
        "@type": {
          "type": "string",
          "const": "QuantitativeValue"
        },
        "value": {
          "type": "string",
          "description": "Humidity percentage as string",
          "pattern": "^[0-9]+\\.[0-9]{2}$",
          "examples": ["65.20"]
        },
        "unitCode": {
          "type": "string",
          "const": "P1",
          "description": "UN/CEFACT unit code for Percent"
        },
        "unitText": {
          "type": "string",
          "const": "%"
        },
        "sensor": {
          "type": "string",
          "examples": ["AHT20", "DHT22"]
        }
      }
    },
    "atmosphericPressure": {
      "type": "object",
      "description": "Atmospheric pressure measurement",
      "required": ["@type", "value", "unitCode", "unitText", "sensor"],
      "properties": {
        "@type": {
          "type": "string",
          "const": "QuantitativeValue"
        },
        "value": {
          "type": "string",
          "description": "Pressure in hPa as string",
          "pattern": "^[0-9]+\\.[0-9]{2}$",
          "examples": ["1013.25"]
        },
        "unitCode": {
          "type": "string",
          "const": "HPA",
          "description": "UN/CEFACT unit code for Hectopascal"
        },
        "unitText": {
          "type": "string",
          "const": "hPa"
        },
        "sensor": {
          "type": "string",
          "examples": ["BMP280", "BME280"]
        }
      }
    },
    "windSpeed": {
      "type": "object",
      "description": "Wind speed measurement",
      "required": ["@type", "value", "unitCode", "unitText", "sensor"],
      "properties": {
        "@type": {
          "type": "string",
          "const": "QuantitativeValue"
        },
        "value": {
          "type": "string",
          "description": "Wind speed in km/h as string",
          "pattern": "^[0-9]+\\.[0-9]{2}$",
          "examples": ["5.20"]
        },
        "unitCode": {
          "type": "string",
          "const": "KMH",
          "description": "UN/CEFACT unit code for Kilometre per hour"
        },
        "unitText": {
          "type": "string",
          "const": "km/h"
        },
        "sensor": {
          "type": "string",
          "examples": ["Anemometer"]
        }
      }
    },
    "precipitation": {
      "type": "object",
      "description": "Precipitation sensor reading (raw ADC value)",
      "required": ["@type", "rawLevel", "unitCode", "unitText", "sensor", "note"],
      "properties": {
        "@type": {
          "type": "string",
          "const": "QuantitativeValue"
        },
        "rawLevel": {
          "type": "integer",
          "description": "Raw ADC value from raindrop sensor",
          "minimum": 0,
          "maximum": 1023,
          "examples": [100]
        },
        "unitCode": {
          "type": "string",
          "const": "ADC"
        },
        "unitText": {
          "type": "string",
          "const": "ADC (0-1023)"
        },
        "sensor": {
          "type": "string",
          "examples": ["Raindrop", "Rain gauge"]
        },
        "note": {
          "type": "string",
          "description": "Interpretation guide",
          "examples": ["0=basah, 1023=kering"]
        }
      }
    },
    "illuminance": {
      "type": "object",
      "description": "Light level sensor reading (raw ADC value)",
      "required": ["@type", "rawLevel", "unitCode", "unitText", "sensor", "note"],
      "properties": {
        "@type": {
          "type": "string",
          "const": "QuantitativeValue"
        },
        "rawLevel": {
          "type": "integer",
          "description": "Raw ADC value from light sensor",
          "minimum": 0,
          "maximum": 1023,
          "examples": [800]
        },
        "unitCode": {
          "type": "string",
          "const": "ADC"
        },
        "unitText": {
          "type": "string",
          "const": "ADC (0-1023)"
        },
        "sensor": {
          "type": "string",
          "examples": ["LDR", "BH1750"]
        },
        "note": {
          "type": "string",
          "description": "Interpretation guide",
          "examples": ["0=gelap, 1023=terang"]
        }
      }
    },
    "signal": {
      "type": "object",
      "description": "LoRa signal quality metrics",
      "required": ["rssi", "snr", "protocol"],
      "properties": {
        "rssi": {
          "type": "integer",
          "description": "Received Signal Strength Indicator in dBm",
          "maximum": 0,
          "examples": [-45, -80, -120]
        },
        "snr": {
          "type": "string",
          "description": "Signal-to-Noise Ratio in dB",
          "pattern": "^-?[0-9]+\\.[0-9]$",
          "examples": ["9.5", "-5.2"]
        },
        "protocol": {
          "type": "string",
          "const": "LoRa 433MHz",
          "description": "Communication protocol"
        }
      }
    }
  },
  "additionalProperties": false
}
